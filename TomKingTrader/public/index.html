<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TomKingTrader - Professional Trading Dashboard</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
</head>
<body>
    <div id="app" class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <h1>üìä TomKingTrader</h1>
                    <span class="version">v17</span>
                </div>
                
                <div class="status-section">
                    <div class="connection-status" id="connectionStatus">
                        <span class="status-indicator" id="statusIndicator"></span>
                        <span id="statusText">Connecting...</span>
                    </div>
                    
                    <div class="mode-toggle">
                        <label for="modeSwitch">API Mode</label>
                        <input type="checkbox" id="modeSwitch" class="mode-switch">
                        <label for="modeSwitch" class="switch-label">Manual</label>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- System Status Panel -->
            <section class="panel status-panel">
                <h2>üéØ System Status</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <label>Account Phase</label>
                        <span id="accountPhase" class="value phase-1">Phase 1</span>
                    </div>
                    <div class="status-item">
                        <label>Account Value</label>
                        <span id="accountValue" class="value">¬£30,000</span>
                    </div>
                    <div class="status-item">
                        <label>Positions</label>
                        <span id="positionCount" class="value">0</span>
                    </div>
                    <div class="status-item">
                        <label>BP Usage</label>
                        <span id="bpUsage" class="value">0%</span>
                    </div>
                    <div class="status-item">
                        <label>Risk Level</label>
                        <span id="riskLevel" class="value risk-low">LOW</span>
                    </div>
                    <div class="status-item">
                        <label>VIX Regime</label>
                        <span id="vixRegime" class="value">NORMAL</span>
                    </div>
                    <div class="status-item">
                        <label>Last Update</label>
                        <span id="lastUpdate" class="value">Never</span>
                    </div>
                    <div class="status-item">
                        <label>Active Signals</label>
                        <span id="activeSignals" class="value">0</span>
                    </div>
                </div>
            </section>

            <!-- Initialization Panel -->
            <section class="panel init-panel" id="initPanel">
                <h2>üöÄ System Initialization</h2>
                <form id="initForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="apiModeInput">Trading Mode</label>
                            <select id="apiModeInput" name="apiMode">
                                <option value="false">Manual Mode</option>
                                <option value="true">API Mode (TastyTrade)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="phaseInput">Account Phase</label>
                            <select id="phaseInput" name="phase">
                                <option value="1">Phase 1 (¬£30-40k)</option>
                                <option value="2">Phase 2 (¬£40-60k)</option>
                                <option value="3">Phase 3 (¬£60-75k)</option>
                                <option value="4">Phase 4 (¬£75k+)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="accountValueInput">Account Value (¬£)</label>
                            <input type="number" id="accountValueInput" name="accountValue" 
                                   min="30000" max="500000" step="1000" value="30000">
                        </div>
                        
                        <div class="form-group api-credentials" id="apiCredentials" style="display: none;">
                            <label>API Credentials</label>
                            <p class="help-text">API credentials are pre-configured. Toggle API mode to connect.</p>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" id="initButton">
                        üöÄ Initialize System
                    </button>
                </form>
            </section>

            <!-- Signal Alerts Panel -->
            <section class="panel signals-panel">
                <h2>üéØ Signal Alerts</h2>
                <div class="signals-header">
                    <div class="signal-stats">
                        <span class="stat">Entry: <span id="entrySignals">0</span></span>
                        <span class="stat">Exit: <span id="exitSignals">0</span></span>
                        <span class="stat">Risk: <span id="riskSignals">0</span></span>
                    </div>
                    <button class="btn btn-small" id="refreshSignals">üîÑ Refresh</button>
                </div>
                <div id="signalsList" class="signals-list">
                    <div class="empty-state">
                        <p>üîç No active signals</p>
                        <p class="subtitle">Initialize system and run analysis to generate signals</p>
                    </div>
                </div>
            </section>

            <!-- Positions Panel -->
            <section class="panel positions-panel">
                <h2>üìä Active Positions</h2>
                <div class="positions-header">
                    <div class="position-stats">
                        <span class="stat">Total: <span id="totalPositions">0</span></span>
                        <span class="stat">Profit: <span id="profitablePositions">0</span></span>
                        <span class="stat">At Risk: <span id="riskPositions">0</span></span>
                    </div>
                </div>
                <div id="positionsList" class="positions-list">
                    <div class="empty-state">
                        <p>üìã No positions</p>
                        <p class="subtitle">Positions will appear here when loaded</p>
                    </div>
                </div>
            </section>

            <!-- Analysis Panel -->
            <section class="panel analysis-panel">
                <h2>üß† Pattern Analysis</h2>
                <div class="analysis-tabs">
                    <button class="tab-btn active" data-tab="patterns">Patterns</button>
                    <button class="tab-btn" data-tab="greeks">Greeks</button>
                    <button class="tab-btn" data-tab="risk">Risk</button>
                </div>
                
                <div id="patternsTab" class="tab-content active">
                    <div id="patternsResults" class="patterns-results">
                        <div class="empty-state">
                            <p>üîç No pattern analysis</p>
                            <p class="subtitle">Run analysis to see pattern results</p>
                        </div>
                    </div>
                </div>
                
                <div id="greeksTab" class="tab-content">
                    <div class="greeks-grid">
                        <div class="greek-item">
                            <label>Net Delta</label>
                            <span id="netDelta" class="value">0</span>
                        </div>
                        <div class="greek-item">
                            <label>Net Gamma</label>
                            <span id="netGamma" class="value">0</span>
                        </div>
                        <div class="greek-item">
                            <label>Net Theta</label>
                            <span id="netTheta" class="value">0</span>
                        </div>
                        <div class="greek-item">
                            <label>Net Vega</label>
                            <span id="netVega" class="value">0</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="greeksChart"></canvas>
                    </div>
                </div>
                
                <div id="riskTab" class="tab-content">
                    <div class="risk-metrics">
                        <div class="risk-item">
                            <label>Correlation Groups</label>
                            <div id="correlationGroups" class="correlation-list"></div>
                        </div>
                        <div class="risk-item">
                            <label>VIX Analysis</label>
                            <div id="vixAnalysis" class="vix-info"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Manual Input Panel -->
            <section class="panel manual-panel" id="manualPanel">
                <h2>üìù Manual Data Input</h2>
                
                <div class="manual-tabs">
                    <button class="tab-btn active" data-tab="market">Market Data</button>
                    <button class="tab-btn" data-tab="positions">Positions</button>
                    <button class="tab-btn" data-tab="analysis">Run Analysis</button>
                </div>
                
                <div id="marketTab" class="tab-content active">
                    <form id="marketDataForm">
                        <div class="form-group">
                            <label for="vixLevel">VIX Level</label>
                            <input type="number" id="vixLevel" name="vixLevel" 
                                   min="10" max="80" step="0.1" placeholder="18.5">
                        </div>
                        
                        <div class="form-group">
                            <label for="marketDataJson">Market Data (JSON)</label>
                            <textarea id="marketDataJson" name="marketData" rows="6" 
                                      placeholder='{"ES": {"currentPrice": 4500, "ivRank": 25}, "VIX": {"currentLevel": 18.5}}'></textarea>
                            <p class="help-text">Paste market data JSON or use search parsing instructions</p>
                        </div>
                        
                        <button type="submit" class="btn btn-secondary">üìä Update Market Data</button>
                    </form>
                </div>
                
                <div id="positionsTabContent" class="tab-content">
                    <form id="positionsForm">
                        <div class="form-group">
                            <label for="positionsJson">Positions (JSON Array)</label>
                            <textarea id="positionsJson" name="positions" rows="6" 
                                      placeholder='[{"ticker": "ES", "strategy": "STRANGLE", "dte": 45, "quantity": 2}]'></textarea>
                            <p class="help-text">Enter current positions as JSON array</p>
                        </div>
                        
                        <button type="submit" class="btn btn-secondary">üìã Update Positions</button>
                    </form>
                </div>
                
                <div id="analysisTabContent" class="tab-content">
                    <form id="analysisForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="analysisVix">VIX Level</label>
                                <input type="number" id="analysisVix" name="vixLevel" 
                                       min="10" max="80" step="0.1" value="18.5">
                            </div>
                            
                            <div class="form-group">
                                <label for="analysisPhase">Phase Override</label>
                                <select id="analysisPhase" name="phase">
                                    <option value="">Use System Phase</option>
                                    <option value="1">Phase 1</option>
                                    <option value="2">Phase 2</option>
                                    <option value="3">Phase 3</option>
                                    <option value="4">Phase 4</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" id="runAnalysisBtn">
                            üß† Run Complete Analysis
                        </button>
                    </form>
                </div>
            </section>

            <!-- Charts Panel -->
            <section class="panel charts-panel">
                <h2>üìà Performance Charts</h2>
                <div class="chart-tabs">
                    <button class="tab-btn active" data-tab="pnl">P&L</button>
                    <button class="tab-btn" data-tab="risk-chart">Risk Metrics</button>
                    <button class="tab-btn" data-tab="bp">Buying Power</button>
                </div>
                
                <div id="pnlChart" class="tab-content active">
                    <canvas id="pnlCanvas"></canvas>
                </div>
                
                <div id="riskChart" class="tab-content">
                    <canvas id="riskCanvas"></canvas>
                </div>
                
                <div id="bpChart" class="tab-content">
                    <canvas id="bpCanvas"></canvas>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <p>&copy; 2024 TomKingTrader Framework v17 | 
                       <span id="footerStatus">System Ready</span> | 
                       Last: <span id="footerLastUpdate">Never</span>
                    </p>
                </div>
                <div class="footer-section">
                    <span>üéØ Goal: ¬£30k ‚Üí ¬£100k in 18 months</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Notification Container -->
    <div id="notifications" class="notifications"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p id="loadingText">Loading...</p>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/dashboard.js"></script>
</body>
</html>